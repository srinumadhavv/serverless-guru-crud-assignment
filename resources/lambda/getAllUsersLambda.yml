name: get-all-users-${self:provider.stage}
handler: src/lambdas/getAllUsers/index.handler
layers:
  - { "Ref":  NodejsLambdaLayer}
events: #this event will trigger defined lambda here to fetch all the User infos
  - http:
      path: /Users
      method: GET
      cors: true
iamRoleStatements:
  - Effect: Allow
    Action:
      - dynamodb:Query
    Resource: #getting the arn of the table and adding /index/* to allow to do query
      - Fn::GetAtt: [UserTable, Arn]
      - Fn::Join:
          - "/"
          - - Fn::GetAtt: [UserTable, Arn]
            - "index/*"